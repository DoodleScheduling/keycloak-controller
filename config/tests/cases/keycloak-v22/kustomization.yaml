apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: k8skeycloak-system

resources: 
- ../../../default
- ../../base

helmCharts:
- repo: https://codecentric.github.io/helm-charts
  name: keycloakx
  version: 1.0.1
  releaseName: keycloakx
  namespace: k8skeycloak-system
  valuesInline:
    image:
      tag: "22.0.0"

    extraEnv: |
      - name: KEYCLOAK_USER
        value: admin
      - name: KEYCLOAK_PASSWORD
        value: admin
      - name: JAVA_OPTS_APPEND
        value: >-
          -Djgroups.dns.query=keycloakx-headless

images:
- name: ghcr.io/doodlescheduling/k8skeycloak-controller
  newTag: latest
  newName: k8skeycloak-controller

patchesStrategicMerge:
- | 
  apiVersion: keycloak.infra.doodle.com/v1beta1
  kind: KeycloakRealm
  metadata:
    name: test
  spec:
    version: 22.0.0
